# ๐ ุฏููู ุงูุงูุชูุงู ุฅูู Supabase PostgreSQL

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุญุฏูุซ ุงููุดุฑูุน ููุนูู ูุน **Supabase PostgreSQL** ุจุฏูุงู ูู SQLite ุงููุญููุฉ. ูุฐุง ุงูุฏููู ูุดุฑุญ ูู ุดูุก ุชุญุชุงุฌ ูุนุฑูุชู.

---

## โ ูุง ุชู ุชูููุฐู

### 1. ุชุญุฏูุซ ููู `.env`
- โ ุฅุถุงูุฉ `DATABASE_URL` ูู Connection Pooling
- โ ุฅุถุงูุฉ `DIRECT_URL` ููู Migrations
- โ ุชูุนูู ูุชุบูุฑุงุช Supabase API
- โ ุชุนุทูู SQLite ุงููุญููุฉ

### 2. ุชุญุฏูุซ `prisma/schema.prisma`
- โ ุชุบููุฑ Provider ูู `sqlite` ุฅูู `postgresql`
- โ ุฅุถุงูุฉ `directUrl` ููู datasource
- โ ุฌููุน Models ูุชูุงููุฉ ูุน PostgreSQL

### 3. ูููุงุช ุงูุฅุนุฏุงุฏ
- โ `setup-supabase-postgresql.bat` - ุณูุฑูุจุช ุงูุฅุนุฏุงุฏ ุงูุขูู
- โ `test-supabase-connection.js` - ุณูุฑูุจุช ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

---

## ๐ฏ ุฎุทูุงุช ุงูุชุดุบูู (ูุทููุจุฉ!)

### ุงูุฎุทูุฉ 1: ุชุดุบูู ุณูุฑูุจุช ุงูุฅุนุฏุงุฏ

ูู ุจุชุดุบูู ุงูุฃูุฑ ุงูุชุงูู:

```bash
setup-supabase-postgresql.bat
```

**ูุงุฐุง ููุนู ูุฐุง ุงูุณูุฑูุจุชุ**
1. ุญุฐู Prisma Client ุงููุฏูู (SQLite)
2. ุญุฐู migrations ุงููุฏููุฉ
3. ุฅูุดุงุก migration ุฌุฏูุฏ ููู PostgreSQL
4. ุชุญุฏูุซ Prisma Client
5. ุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู ูู Supabase

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุงุฑ ุงูุงุชุตุงู

ุจุนุฏ ูุฌุงุญ ุงูุฅุนุฏุงุฏุ ูู ุจุงุฎุชุจุงุฑ ุงูุงุชุตุงู:

```bash
node test-supabase-connection.js
```

**ูุงุฐุง ูุฎุชุจุฑุ**
- โ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุชูููุฐ ุงุณุชุนูุงูุงุช
- โ ูุญุต ุงูุฌุฏุงูู ุงููููุดุฃุฉ
- โ ุนุฏ ุงูุณุฌูุงุช

### ุงูุฎุทูุฉ 3: ุชุดุบูู ุงููุดุฑูุน

```bash
npm run dev
```

ุงูุชุญ ุงููุชุตูุญ ุนูู: `http://localhost:3000`

---

## ๐๏ธ ูุนูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

### Connection Strings

**ููุงุณุชุฎุฏุงู ุงูุนุงุฏู (Connection Pooling):**
```
postgresql://postgres.mmvqjrmkukrmjzakhfrw:bbRSfB6LHcFkgswO@aws-0-eu-central-1.pooler.supabase.com:6543/postgres?pgbouncer=true
```

**ููู Migrations (Direct Connection):**
```
postgresql://postgres.mmvqjrmkukrmjzakhfrw:bbRSfB6LHcFkgswO@db.mmvqjrmkukrmjzakhfrw.supabase.co:5432/postgres
```

### Supabase Dashboard

ููููู ุงููุตูู ุฅูู ููุญุฉ ุงูุชุญูู:
- URL: https://gsbdlsehmmdjfvkaphdy.supabase.co
- Project: mmvqjrmkukrmjzakhfrw

---

## ๐ ุงูุฌุฏุงูู ุงููููุดุฃุฉ

ุณูุชู ุฅูุดุงุก ุงูุฌุฏุงูู ุงูุชุงููุฉ ูู Supabase:

1. **users** - ุงููุณุชุฎุฏููู
2. **accounts** - ุญุณุงุจุงุช OAuth
3. **sessions** - ุฌูุณุงุช NextAuth
4. **verification_tokens** - ุฑููุฒ ุงูุชุญูู
5. **families** - ุงูุนุงุฆูุงุช
6. **family_members** - ุฃุนุถุงุก ุงูุนุงุฆูุงุช
7. **categories** - ุงูุชุตูููุงุช
8. **subcategories** - ุงูุชุตูููุงุช ุงููุฑุนูุฉ
9. **incomes** - ุงูุฏุฎู
10. **expenses** - ุงููุตุฑููุงุช
11. **budgets** - ุงูููุฒุงููุงุช
12. **category_budgets** - ููุฒุงููุงุช ุงูุชุตูููุงุช
13. **events** - ุงูููุงุณุจุงุช
14. **bills** - ุงูููุงุชูุฑ
15. **bill_participants** - ุงููุดุงุฑููู ูู ุงูููุงุชูุฑ
16. **subscriptions** - ุงูุงุดุชุฑุงูุงุช
17. **stripe_event_logs** - ุณุฌูุงุช Stripe
18. **advices** - ุงููุตุงุฆุญ
19. **forecasts** - ุงูุชููุนุงุช

---

## ๐ง ุฃูุงูุฑ ูููุฏุฉ

### Prisma Studio
ููุชุญ ูุงุฌูุฉ ุฑุณูููุฉ ูุฅุฏุงุฑุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```bash
npx prisma studio
```

### ุฅูุดุงุก Migration ุฌุฏูุฏ
ุฅุฐุง ููุช ุจุชุนุฏูู Schema:
```bash
npx prisma migrate dev --name description_of_changes
```

### ุชุญุฏูุซ Prisma Client
ุจุนุฏ ุชุนุฏูู Schema:
```bash
npx prisma generate
```

### Push Schema (ููุชุทููุฑ ุงูุณุฑูุน)
ุจุฏูู ุฅูุดุงุก migration:
```bash
npx prisma db push
```

### ุฅุนุงุฏุฉ ุชุนููู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฎุทุฑ!)
ุญุฐู ุฌููุน ุงูุจูุงูุงุช:
```bash
npx prisma migrate reset
```

---

## ๐ฑ ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ

ูุฅุถุงูุฉ ุชุตูููุงุช ูุจูุงูุงุช ุฃูููุฉ:

```bash
node prisma/seed.js
```

---

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุฎุทุฃ: "Authentication failed"
**ุงูุญู:**
1. ุชุฃูุฏ ูู ุตุญุฉ ูููุฉ ุงููุฑูุฑ ูู `.env`
2. ุชุญูู ูู Connection String
3. ุชุฃูุฏ ูู ุฃู IP ุงูุฎุงุต ุจู ูุณููุญ ูู Supabase

### ุฎุทุฃ: "Can't reach database server"
**ุงูุญู:**
1. ุชุญูู ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช
2. ุชุฃูุฏ ูู ุฃู Supabase ูุนูู
3. ุฌุฑุจ ุงุณุชุฎุฏุงู DIRECT_URL ุจุฏูุงู ูู DATABASE_URL

### ุฎุทุฃ: "Table does not exist"
**ุงูุญู:**
```bash
# ุฃุนุฏ ุชุดุบูู ุณูุฑูุจุช ุงูุฅุนุฏุงุฏ
setup-supabase-postgresql.bat
```

### ุฎุทุฃ: "Prisma Client is not configured"
**ุงูุญู:**
```bash
# ุฃุนุฏ ุฅูุดุงุก Prisma Client
npx prisma generate
```

---

## ๐ ุงูุฃูุงู

### ูุง ุชุดุงุฑู ุฃุจุฏุงู:
- โ `DIRECT_URL` ุฃู `DATABASE_URL`
- โ `SUPABASE_SERVICE_ROLE_KEY`
- โ ูููุงุช ุงููุฑูุฑ

### ูููู ูุดุงุฑูุฉ:
- โ `NEXT_PUBLIC_SUPABASE_URL`
- โ `NEXT_PUBLIC_SUPABASE_ANON_KEY`

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุฅุชูุงู ุงูุฅุนุฏุงุฏ:

1. โ ุงุฎุชุจุฑ ุชุณุฌูู ุงูุฏุฎูู
2. โ ุฃุถู ูุตุฑูู ุชุฌุฑูุจู
3. โ ุชุฃูุฏ ูู ุญูุธ ุงูุจูุงูุงุช
4. โ ุงูุชุญ Prisma Studio ูุชุญูู ูู ุงูุจูุงูุงุช
5. โ ุงุฎุชุจุฑ ุฌููุน ุงูุตูุญุงุช

---

## ๐ ุงููุชูุฌุฉ

ุงูุขู ูุฏูู:
- โ ูุงุนุฏุฉ ุจูุงูุงุช ุณุญุงุจูุฉ (Supabase)
- โ ูุณุฎ ุงุญุชูุงุทู ุชููุงุฆู
- โ ูุงุจููุฉ ููุชูุณุน
- โ ุฃุฏุงุก ุฃูุถู
- โ ุฌุงูุฒ ููุฅูุชุงุฌ (Production)

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุฑุงุฌุน ูุณู "ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ" ุฃุนูุงู
2. ุดุบู `test-supabase-connection.js` ููุชุดุฎูุต
3. ุชุญูู ูู logs ูู Supabase Dashboard

---

**ุชู ุจูุงุณุทุฉ:** Abdullah Alawiss (Cline AI Assistant)
**ุงูุชุงุฑูุฎ:** 2025-10-22
